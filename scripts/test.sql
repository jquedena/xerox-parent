SET SERVEROUTPUT ON;
DECLARE
  USUARIO VARCHAR2(200);
  ID_PROCESO NUMBER;
  FILAS_LEIDAS NUMBER;
  FILAS_ESCRITAS NUMBER;
  ESTADO VARCHAR2(200);
  DESCRIPCION VARCHAR2(200);
BEGIN
  USUARIO := '----';
  ID_PROCESO := -31;

  DELETE FROM FATCA.LOG WHERE PROCESO_ID = ID_PROCESO;
  UPDATE CUENTAS SET ESTADO_PROCESO='2' WHERE ESTADO_PROCESO='1';
  COMMIT;

  PKG_PROCESOS_SALIDA.SP_CARGAR_FATCA(
    USUARIO => USUARIO,
    ID_PROCESO => ID_PROCESO,
    FILAS_LEIDAS => FILAS_LEIDAS,
    FILAS_ESCRITAS => FILAS_ESCRITAS,
    ESTADO => ESTADO,
    DESCRIPCION => DESCRIPCION
  );

DBMS_OUTPUT.PUT_LINE('FILAS_LEIDAS = ' || FILAS_LEIDAS);
DBMS_OUTPUT.PUT_LINE('FILAS_ESCRITAS = ' || FILAS_ESCRITAS);
DBMS_OUTPUT.PUT_LINE('ESTADO = ' || ESTADO);
DBMS_OUTPUT.PUT_LINE('DESCRIPCION = ' || DESCRIPCION);
END;

/*
SELECT MAX(DOC_REF_ID)
FROM FATCA.ACCOUNT_REPORT AR
LEFT JOIN FATCA.REPORTING_GROUP RG ON AR.REPORTING_GROUP_ID = RG.ID
LEFT JOIN FATCA.FATCA FA ON RG.FATCA_ID = FA.ID
LEFT JOIN FATCA.FATCA_OECD FO ON FA.FATCA_OECD_ID = FO.ID
WHERE AR.ACCOUNT_NUMBER = :P_NRO_CUENTA AND AR.ESTADO = '1' AND FO.ID = :P_FATCA_OECD_ID;

SELECT * FROM FATCA.FATCA_OECD A
WHERE A.ID = 12
*/

/*
      SELECT MAX(DOC_REF_ID) INTO V_REFERENCIA  FROM FATCA.ACCOUNT_REPORT AR
      LEFT JOIN FATCA.REPORTING_GROUP RG ON AR.REPORTING_GROUP_ID = RG.ID
      LEFT JOIN FATCA.FATCA FA ON RG.FATCA_ID = FA.ID
      LEFT JOIN FATCA.FATCA_OECD FO ON FA.FATCA_OECD_ID = FO.ID
      WHERE AR.ACCOUNT_NUMBER = P_NRO_CUENTA AND AR.ESTADO = '1' AND FO.ID = P_FATCA_OECD_ID;

bloque anónimo terminado
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 00110661000300043725
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 00110661000300049278
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 00110357000100033722
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 00110357000300035592
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 00110357000710010333
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 3420813 00
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 00110101000300045560
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 00110101000300046281
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 00110101005001131800
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 00110501480709977937
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 00110661000300049669
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 00110378000300004764
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 00110378000300008204
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - OPTPV18 00
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - OPTPV1  00
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 00110378000300008247
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 00110469000300006842
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 00110686350300001344
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 00110955000300023544
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 00110955000300024729
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 3024482900
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 3024492300
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 3024492600
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 3024486800
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 3024554800
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 5809039000
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 5780930400
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 5780930500
ERROR AL EJECUTAR FUNCTION SF_OBTENER_DOCREFID: 12 - 5780938300
FILAS_LEIDAS = 29
FILAS_ESCRITAS = 29
ESTADO = EXITO
DESCRIPCION = EXITO
*/
